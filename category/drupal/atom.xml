<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: drupal | Linux Sysadmin Blog]]></title>
  <link href="http://linuxsysadminblog.com/category/drupal/atom.xml" rel="self"/>
  <link href="http://linuxsysadminblog.com/"/>
  <updated>2012-11-13T01:37:44+08:00</updated>
  <id>http://linuxsysadminblog.com/</id>
  <author>
    <name><![CDATA[Promet OPS Team]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Moving Drupal site with CiviCRM]]></title>
    <link href="http://linuxsysadminblog.com/2011/04/moving-drupal-site-with-civicrm/"/>
    <updated>2011-04-11T10:24:29+08:00</updated>
    <id>http://linuxsysadminblog.com/2011/04/moving-drupal-site-with-civicrm</id>
    <content type="html"><![CDATA[<p>The common headache for beginners who try to move their Drupal site with CiviCRM is the CiviCRM configuration on new location or domain.  I did this countless times and dealt with different problems before.  I've read many online tutorials and how-tos, and I finally have my notes which is working for me everytime i move Drupal and CiviCRM site.</p>

<p>Let's assume you already moved the databases (separate database for Drupal and CiviCRM as a recommended setup) and the files to new location and have set the correct file permissions as well.  Here is the part that you need for your CiviCRM to work on new location and domain:</p>

<ul>
<li>access your database and empty <code>civicrm.domain:config_backend</code>.  You see this anywhere with CiviCRM guide.</li>
<li>update database details, site path/directory, and domain on <code>civicrm.settings.php</code></li>
<li>emtpy <code>sites/default/files/civicrm/template_c</code> (or make this entire dir writable by web user)</li>
<li>login to you new Drupal site and visit these urls:
<code>http://sitename/civicrm/menu/rebuild?reset=1</code>
<code>http://sitename/civicrm/admin/setting/updateConfigBackend?reset=1</code></li>
</ul>


<p><strong>Note:</strong> This will rebuild the settings for you - if not, repeat/review all the above steps.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Install ApacheSolr in Ubuntu for Drupal]]></title>
    <link href="http://linuxsysadminblog.com/2011/04/install-apachesolr-in-ubuntu-for-drupal/"/>
    <updated>2011-04-03T14:26:25+08:00</updated>
    <id>http://linuxsysadminblog.com/2011/04/install-apachesolr-in-ubuntu-for-drupal</id>
    <content type="html"><![CDATA[<p>I've written few Drupal ApacheSolr install guides here and this one is basically an install draft for Ubuntu.</p>

<p><strong>Environment: </strong>  <a href="http://www.ubuntu.com/">Ubuntu 10.10</a>, Apache, PHP, MySQL, <a href="http://drupal.org">Drupal 6.20</a></p>

<p><strong>Things to install / setup</strong>:   <a href="http://apache.rediris.es/lucene/solr/">Solr</a>, <a href="http://tomcat.apache.org/download-60.cgi">Tomcat6</a>, <a href="http://drupal.org/project/apachesolr">ApacheSolr module for Drupal</a>, and <a href="http://code.google.com/p/solr-php-client/">SolrPHPClient library</a></p>

<p><strong>1.)  Install Tomcat and setup your Tomcat admin user.</strong></p>

<p>```
aptitude install tomcat6 tomcat6-admin tomcat6-common tomcat6-user
vi /etc/tomcat6/tomcat-users.xml</p>

<pre><code>&lt;role rolename="admin"/&gt;
&lt;role rolename="manager"/&gt;
&lt;user username="tomcat" password="password" roles="admin,manager"/&gt;
</code></pre>

<p>/etc/init.d/tomcat6 restart
```</p>

<p>If all is good you will be able to access Tomcat admin at <code>http://hostname:8080</code>.  Default page will show with links to admin section, etc.</p>

<p><strong>2.)  Install Solr</strong></p>

<p><code>
wget http://apache.rediris.es/lucene/solr/1.4.1/apache-solr-1.4.1.zip
</code>
<a href="http://apache.rediris.es/lucene/solr/"><em>check for updates</em></a>
```
unzip apache-solr-1.4.1.zip
mkdir /usr/share/tomcat6/webapps
cp apache-solr-1.4.1/dist/apache-solr-1.4.1.war /usr/share/tomcat6/webapps/solr.war
cp -r apache-solr-1.4.1/example/solr /usr/share/tomcat6/solr
vi /etc/tomcat6/Catalina/localhost/solr.xml</p>

<pre><code>&lt;Context docBase="/usr/share/tomcat6/webapps/solr.war" debug="0" privileged="true" allowLinking="true" crossContext="true"&gt;
&lt;Environment name="solr/home" type="java.lang.String" value="/usr/share/tomcat6/solr" override="true" /&gt;
&lt;/Context&gt;
</code></pre>

<p>chown -r tomcat6.tomcat6 /var/lib/tomcat6
/etc/init.d/tomcat6 restart
```</p>

<p>You should see Solr access on your Tomcat admin/manager page (<code>http://hostname:8080/manager/html</code>).</p>

<p><strong>3.)  Connect Drupal Site to Solr (multi-core setup)</strong></p>

<p>I already have a Drupal site with ApacheSolr module installed and SolrPHPclient library.</p>

<!--more-->


<p><code>``
cp /path/drupal_site/sites/all/modules/apachesolr/schema.xml /usr/share/tomcat6/solr/conf/schema.xml
cp /path/drupal_site/sites/all/modules/apachesolr/solrconfig.xml /usr/share/tomcat6/solr/conf/solrconfig.xml
cp apache-solr-1.4.1/example/multicore/solr.xml /usr/share/tomcat6/solr/
mkdir /usr/share/tomcat6/solr/site_sample1
cp -r /usr/share/tomcat6/solr/conf /usr/share/tomcat6/solr/site_sample1/conf
vi /usr/share/tomcat6/solr/solr.xml</code></p>

<pre><code>&lt;core name="site1" instanceDir="site_sample1" /&gt;
</code></pre>

<p>chown -R tomcat6:root /usr/share/tomcat6/solr/
/etc/init.d/tomcat6 restart
```</p>

<p>Visit ApacheSolr settings of your Drupal admin and enter the configuration:
<code>
Solr Hostname: localhost
Solr Port: 8080
Solr Path: /solr/site1
</code></p>

<p><strong>To add new site to Solr:</strong>
```
mkdir /usr/share/tomcat6/solr/site_sample2
cp -r /usr/share/tomcat6/solr/conf /usr/share/tomcat6/solr/site_sample2/conf
vi /usr/share/tomcat6/solr/solr.xml</p>

<pre><code>&lt;core name="site2" instanceDir="site_sample2" /&gt;
</code></pre>

<p>```</p>

<p>That's All.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hosting presentation at DrupalCon2011]]></title>
    <link href="http://linuxsysadminblog.com/2011/03/hosting-presentation-at-drupalcon2011/"/>
    <updated>2011-03-27T19:08:20+08:00</updated>
    <id>http://linuxsysadminblog.com/2011/03/hosting-presentation-at-drupalcon2011</id>
    <content type="html"><![CDATA[<p>Below is my presentation from Drupal Con 2011 where Promet Source, a <a href="http://www.prometsource.com">Drupal Development Company</a> based out of Chicago was a Gold sponsor.  Although none or our proposed talks got in, we did get a slot at the Main stage.  Below are the slides of my talk.  Basically we wanted to highlight that while we do focus on automation, performance and security, with Drupal the security updates must be integrated with human support to ensure that updates do not break the site.</p>

<p><strong><a href="http://www.slideshare.net/akucharski/what-should-you-expect-from-your-drupal-web-host">What should you expect from your Drupal Web Host</a></strong></p>

<p>View more <a href="http://www.slideshare.net/">presentations</a> from <a href="http://www.slideshare.net/akucharski">Promet Solutions</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Install Apache Solr and Tomcat for Drupal]]></title>
    <link href="http://linuxsysadminblog.com/2010/10/install-apache-solr-and-tomcat-for-drupal/"/>
    <updated>2010-10-17T05:10:55+08:00</updated>
    <id>http://linuxsysadminblog.com/2010/10/install-apache-solr-and-tomcat-for-drupal</id>
    <content type="html"><![CDATA[<p>Here's my quick install guide for Solr, Tomcat, and Drupal ApacheSolr module for multiple sites.  Mostly I based the steps below from the following sites: <a href="http://wiki.apache.org/solr/SolrTomcat">wiki.apache.org</a> and <a href="http://www.drupalconnect.com/blog/steve/configuring-apache-solr-multi-core-drupal-and-tomcat-ubuntu-910">drupalconnect.com</a>.</p>

<p><strong>Detailed Setup:</strong></p>

<ul>
<li>Drupal 6.19</li>
<li>ApacheSolr module 6-1.1</li>
<li>Apache Solr PHP Client Library: Rev.22</li>
<li>Solr 1.4.1</li>
<li>Tomcat 6.0.29</li>
<li>SunJDK 6update21</li>
<li>RHEL5.5x64</li>
</ul>


<p><strong>Install Process: Tomcat</strong></p>

<ul>
<li>Create <code>solr</code> user</li>
<li>Download <a href="http://tomcat.apache.org/download-60.cgi">Tomcat6</a></li>
<li>Extract to <code>/opt/tomcat</code>,  <em>this will be the <code>$CATALINA_HOME</code> directory, you can use any dir you want</em></li>
<li>Edit <code>/opt/tomcat/conf/tomcat-users.xml</code> to enable Tomcat login.  See comments in this file.
<code>
&lt;role rolename="manager"/&gt;
&lt;role rolename="admin"/&gt;
&lt;user username="tomcat" password="tomcat" roles="manager,admin"/&gt;
</code></li>
<li>Test run your Tomcat:  <code>/opt/tomcat/bin/catalina.sh run</code>.  Chown all Tomcat files to <code>solr</code> user (<code>chown -R solr.solr /opt/tomcat</code>).  Default server setting will use port 8080, to customized edit the file <code>/opt/tomcat/conf/server.xml</code>.  If you encounter error on "<em>BASEDIR environment variable is not defined correctly...</em>", check permissions of <code>.sh</code> files inside <code>/opt/tomcat/bin/</code> and make them executable (<code>chmod 755 /opt/tomcat/bin/*.sh</code>).</li>
<li>Add startup (init) script.  Copy this <a href="http://wiki.apache.org/solr/SolrTomcat?action=AttachFile&amp;do=view&amp;target=tomcat6">Tomcat6 init file</a> from Apache.org to <em>/etc/init.d/tomcat6</em>.  Check and update variables like Java home, Tomcat directory, etc, if needed.  Add to startup <code>/sbin/chkconfig --add tomcat6</code> and <code>/sbin/chkconfig tomcat6 on</code>.  Dependencies: redhat-lsb (or lsb-base?)</li>
<li>Visit your Tomcat Admin page.  ex <em>http://localhost:8080</em></li>
</ul>


<p><strong>Install Process: Solr</strong></p>

<ul>
<li>Download <a href="http://mirrors.igsobe.com/apache/lucene/solr/">Solr</a></li>
<li>Extract to temporary location, ex: <code>/opt/apache-solr-1.4.1</code></li>
<li>Copy <code>/opt/apache-solr-1.4.1/dist/apache-solr-1.4.1.war</code> to <code>/opt/tomcat/webapps/solr.war</code></li>
<li>Copy <code>/opt/apache-solr-1.4.1/example/solr</code> directory to <code>/opt/tomcat/solr</code>  <em>this will be the <code>$SOLR_HOME</code> directory, you can use any dir you want</em></li>
<li>Create file <code>/opt/tomcat/conf/Catalina/localhost/solr.xml</code> with the following configuration.  Make sure paths are correct.
<code>
&lt;Context docBase="/opt/tomcat/webapps/solr.war" debug="0" privileged="true" allowLinking="true" crossContext="true"&gt;
&lt;Environment name="solr/home" type="java.lang.String" value="/opt/tomcat/solr" override="true" /&gt;
&lt;/Context&gt;
</code></li>
</ul>


<p><strong>Install Process: ApacheSolr Drupal module and SolrPHP client</strong></p>

<ul>
<li>Install/enable <a href="http://drupal.org/project/apachesolr">Drupal ApacheSolr</a> module. Drush, CVS, or traditional install - whatever you want.  Example: <code>/var/www/site1/sites/all/modules/apachesolr</code></li>
<li>Download <a href="http://code.google.com/p/solr-php-client/">SolrPHP client library</a></li>
</ul>


<p><strong>Configure Solr for Multi-Core Setup</strong></p>

<ul>
<li>Copy <code>/var/www/site1/sites/all/modules/apachesolr/schema.xml</code> to <code>/opt/tomcat/solr/conf/schema.xml</code></li>
<li>Copy <code>/var/www/site1/sites/all/modules/apachesolr/solrconfig.xml</code> to <code>/opt/tomcat/solr/conf/solrconfig.xml</code></li>
<li>Copy <code>/opt/apache-solr-1.4.1/example/multicore/solr.xml</code> to <code>/opt/tomcat/solr/solr.xml</code></li>
<li>Create directory for each site and copy <code>/opt/tomcat/solr/conf</code> directory to each of them. Example:
<code>
mkdir /opt/tomcat/solr/site1
mkdir /opt/tomcat/solr/site2
cp -r /opt/tomcat/solr/conf /opt/tomcat/solr/site1/
cp -r /opt/tomcat/solr/conf /opt/tomcat/solr/site2/
</code></li>
<li>Edit <code>/opt/tomcat/solr/solr.xml</code> with the following config:
<code>
&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;solr persistent="false"&gt;
&lt;cores adminPath="/admin/cores"&gt;
&lt;core name="site1" instanceDir="site1" /&gt;
&lt;core name="site1" instanceDir="site2" /&gt;
&lt;/cores&gt;
&lt;/solr&gt;
</code></li>
<li>Start or Restart Tomcat: <code>/etc/init.d/tomcat6 start</code></li>
<li>Visit <code>http://localhost:8080/</code> and go to you Solr App</li>
</ul>


<p><strong>Configure Drupal site:</strong></p>

<ul>
<li>Go to ApacheSolr settings <code>http://localhost/admin/settings/apachesolr</code></li>
<li>Save your config and if all is good you'll see message: <code>Your site has contacted the Apache Solr server.</code>
<code>
Solr host name: localhost
Solr port: 8080
Solr path (for site1): /solr/site1
</code></li>
<li>Configure your search index.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Drupal Performance talk video from Drupal Con 2010]]></title>
    <link href="http://linuxsysadminblog.com/2010/07/drupal-performance-talk-video-from-drupal-con-2010/"/>
    <updated>2010-07-29T23:01:17+08:00</updated>
    <id>http://linuxsysadminblog.com/2010/07/drupal-performance-talk-video-from-drupal-con-2010</id>
    <content type="html"><![CDATA[<p>I have already mentioned that <a href="http://linuxsysadminblog.com/2010/04/google-will-use-site-performance-and-page-load-speed-in-serp-ranking-sysadmin-seo-here-we-come/">google will start penalizing your site</a> in search if it is not fast enough.  I have recently given a presentation at Drupal Con about Drupal performance and page speed.  Below is a video of our session - its currently the fifth most watched session from the conference according to <a href="http://www.archive.org/search.php?query=DrupalCon%20SF%202010&amp;sort=-downloads">archive.org</a>.  Alternatively, there are several different formats <a href="http://www.archive.org/details/MakeDrupalRunFast-IncreasePageLoadSpeed">there as well</a>.</p>
]]></content>
  </entry>
  
</feed>
