
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Cisco ASA 5505: Active/Standby Failover Configuration - Linux Sysadmin Blog</title>
  <meta name="author" content="Promet OPS Team">

  
  <meta name="description" content="The ASA 5505 is the smallest (and cheapest) solution from the current Cisco hardware security appliances. Still, if we have the proper software &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://linuxsysadminblog.com/2009/02/cisco-asa-5505-activestandby-failover-configuration/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Linux Sysadmin Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<!-- Google Form for Contact Page -->
<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
    // Avoid conflict with ender.js.
jQuery.noConflict();
</script>
<!-- jQuery Form Plugin -->
<script src="http://malsup.github.com/jquery.form.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script> 
<script src="/javascripts/google_form.js"></script>
<!-- Google Form for Contact Page End here -->


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-120251-38']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Linux Sysadmin Blog</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:linuxsysadminblog.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/our-team">Our Team</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/about">About</a></li>
  <li><a href="/blog/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      

<div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Cisco ASA 5505: Active/Standby Failover Configuration</h1>
    
    
      <p class="meta">
        
  


<span class="byline author vcard">Posted by <span class="fn"><a href="/blog/our-team/marius-ducea.html">Marius Ducea</a></span></span>

 - 








  


<time datetime="2009-02-17T06:35:57+08:00" pubdate data-updated="true">Feb 17<span>th</span>, 2009</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>The <strong>ASA 5505</strong> is the smallest (and cheapest) solution from the current Cisco hardware security appliances. Still, if we have the proper software license (like <em>Security Plus</em> for example) we can use the ASA5505 to setup rather complex solutions. This post will show how we can setup a pair of <strong>ASA5505 in failover configuration</strong>, solution that can be very useful in a small office where we want to achieve a high availability and we can&#8217;t tolerate a failure of our frontend firewall.</p>

<h3>Prerequisites</h3>

<p>Before even starting, let&#8217;s check that our ASA5505&#8217;s are running the appropriate software license. For example the sh run command will output something like this:
<code>sh ver
...
Licensed features for this platform:
Maximum Physical Interfaces  : 8
VLANs                        : 20, DMZ Unrestricted
Inside Hosts                 : Unlimited
**Failover                   : Active/Standby**
VPN-DES                      : Enabled
VPN-3DES-AES                 : Enabled
VPN Peers                    : 25
WebVPN Peers                 : 2
Dual ISPs                    : Enabled
VLAN Trunk Ports             : 8
AnyConnect for Mobile        : Disabled
AnyConnect for Linksys phone : Disabled
Advanced Endpoint Assessment : Disabled
UC Proxy Sessions            : 2
This platform has an ASA 5505 Security Plus license.
.</code>
You should look at the Failover feature and you should have &#8221;<strong>Active/Standby</strong>&#8221;. If this outputs <em>disabled</em>, you will have to order and install a software license upgrade from Cisco in order to be able to use the ASA&#8217;s in failover.</p>

<p>Cisco (as always) has a very complex <a href="http://www.cisco.com/en/US/docs/security/asa/asa72/configuration/guide/failover.html#wp1064158">documentation</a> on how you can achieve this. Still, it is hard to digest, as they try to cover all possible devices on the same page (even the obsolete pix500); even more the ASA5505 has some particularities compared with the rest of the ASA 5500 range of products and <strong>this is not very clearly explained</strong>. <em>Hopefully this post will be more useful and simpler to follow.</em></p>

<p>First we need to understand some limitations of our devices. The ASA5505 can <strong>only perform Active/Standby</strong> failover and <strong>not Active/Active</strong>. If you need that, you will have to look at a higher range device. Also they can only perform <strong>LAN-Based Failover</strong> (as opposed to old pixes that can use cable based failover) and they <strong>don&#8217;t support Stateful Failover</strong> (meaning all active connections will be lost after a failover event). Also both units must have the same hardware, software configuration, and proper license and run in same mode (single or multiple, transparent or routed).</p>

<h3>Configuring the Primary Unit</h3>

<p>For each of the IPs assigned to the interfaces of the ASA we will need to <strong>allocate a secondary IP</strong> from the same network range; this will be used as the IP of the standby unit, while the main IPs will always be used by the primary (active) unit and will be normally used by the clients (as default gateways for ex). The first step is to <strong>configure the active and standby IP addresses for each data interface</strong>; the cisco documentation is confusing here and it is not clear that on the <strong>ASA5505 </strong>this is done for <strong>each of the used vlans, and not real interfaces</strong>:
<code>conf t
(config)#interface Vlan1
(config-if)#ip address active_addr netmask standby standby_addr</code>
for ex:
<code>(config-if)#ip address 192.168.0.1 255.255.255.0 standby 192.168.0.2</code></p>

<p>Once we have defined all standby IPs we can move forward&#8230;
You will also need to define <strong>one interface that will be used for failover</strong>. You can either cross-connect this between the 2 ASAs or you can use a switch with a dedicated vlan for this. The later one is preferred as it will more accurately detect if one ASA is down. Again in the documentation this is not clear how to do it on the ASA5505 and it discusses about <em>real interfaces</em>, while on the <strong>ASA5505 we have to use vlans</strong>.</p>

<p><strong>The trick is to create a new vlan and don&#8217;t assign any ip on the vlan inteface:</strong>
<code>interface Vlan32
description LAN Failover Interface
no shutdown</code>
the ip will be assigned by the failover commands;
Finally <strong>enable failover</strong>:
<code>failover
failover lan unit primary
failover lan interface failover Vlan32
failover interface ip failover 192.168.255.1 255.255.255.0 standby 192.168.255.2</code>
(where you will use one unused ip range for the failover ips).</p>

<p>Save the running config: <strong>copy running-config startup-config</strong></p>

<h3>Configuring the Secondary Unit</h3>

<p>The configuration of the secondary, standby unit is very simple as it needs <strong>only the failover interface configuration</strong>.  The secondary unit requires these commands to initially communicate with the primary unit, and get its configuration from the active unit.</p>

<p>As with the main ASA we have to define the <strong>vlan that will be used for failover</strong> first:
<code>interface Vlan32
description LAN Failover Interface
no shutdown</code></p>

<p>And next we just have to enable failover and set this unit as secondary:
<code>failover
failover lan unit secondary
failover lan interface failover Vlan32
failover interface ip failover 192.168.255.1 255.255.255.0 standby 192.168.255.2</code></p>

<p>After this, the active unit sends the configuration in running memory to the standby unit. As the configuration synchronizes, the messages &#8220;Beginning configuration replication: Sending to mate&#8221; and &#8220;End Configuration Replication to mate&#8221; appear on the active unit console.</p>

<h3>Verifying the Failover Configuration</h3>

<p>The command <strong>show failover</strong> can be used to show the status of the failover operation; the output on the active device will look similar to:
<code>sh failover
Failover On
Failover unit Primary
Failover LAN Interface: failover Vlan32 (up)
Unit Poll frequency 1 seconds, holdtime 15 seconds
Interface Poll frequency 5 seconds, holdtime 25 seconds
Interface Policy 1
Monitored Interfaces 5 of 250 maximum
Version: Ours 8.0(4), Mate 8.0(4)
Last Failover at: 02:28:31 CST Jan 23 2009
This host: Primary - Active
Active time: 2166923 (sec)
slot 0: ASA5505 hw/sw rev (1.0/8.0(4)) status (Up Sys)
Interface inside (10.10.10.1): Normal
Interface outside (192.168.0.1): Normal
slot 1: empty
Other host: Secondary - Standby Ready
Active time: 378 (sec)
slot 0: ASA5505 hw/sw rev (1.0/8.0(4)) status (Up Sys)
Interface inside (10.10.10.2): Normal
Interface outside (192.168.0.2): Normal
slot 1: empty</code></p>

<p>Finally, you will probably want to test the failover functionality and maybe tune the triggers of the failover, but maybe we will talk about this in a future post.
<em>I hope you found this post useful and helped to explain better the steps needed to configure the Active/Standby Failover on the ASA5505.</em></p>
</div>


  <footer>
    <p class="meta">
      
  


<span class="byline author vcard">Posted by <span class="fn"><a href="/blog/our-team/marius-ducea.html">Marius Ducea</a></span></span>


      








  


<time datetime="2009-02-17T06:35:57+08:00" pubdate data-updated="true">Feb 17<span>th</span>, 2009</time>
      

<span class="categories">
  
    <a class='category' href='/category/cli/'>CLI</a>, <a class='category' href='/category/security/'>Security</a>, <a class='category' href='/category/cisco/'>cisco</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://linuxsysadminblog.com/2009/02/cisco-asa-5505-activestandby-failover-configuration/" data-via="linuxsysadmnblg" data-counturl="http://linuxsysadminblog.com/2009/02/cisco-asa-5505-activestandby-failover-configuration/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2009/02/howto-recover-from-a-corrupt-rpm-database/" title="Previous Post: HowTo recover from a corrupt rpm database">&laquo; HowTo recover from a corrupt rpm database</a>
      
      
        <a class="basic-alignment right" href="/2009/02/cloud-computing-scenarios-for-database-servers/" title="next Post: Cloud computing scenario's for database servers">Cloud computing scenario's for database servers &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2012/11/xen-add-extra-partitions-to-guest-os/">Xen: Add Extra Partitions to Guest OS</a>
      </li>
    
      <li class="post">
        <a href="/2012/11/howto-bulk-import-dns-zones-to-softlayer-dns-using-cpanel/">HowTo: Bulk Import DNS Zones to Softlayer DNS using Cpanel</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/integrate-sendgrid-with-redmine/">Integrate Sendgrid with Redmine</a>
      </li>
    
      <li class="post">
        <a href="/2012/07/rsback-task-x-is-locked-and-cannot-be-executed/">rsback: task x is locked and cannot be executed</a>
      </li>
    
      <li class="post">
        <a href="/2012/06/restore-xen-vm-from-lvm-snapshot-backups/">Restore Xen VM from LVM Snapshot Backups</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/promet">@promet</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'promet',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("linuxsysadmnblg", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/linuxsysadmnblg" class="twitter-follow-button" data-show-count="false">Follow @linuxsysadmnblg</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Promet OPS Team -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'linuxsysadminblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://linuxsysadminblog.com/2009/02/cisco-asa-5505-activestandby-failover-configuration/';
        var disqus_url = 'http://linuxsysadminblog.com/2009/02/cisco-asa-5505-activestandby-failover-configuration/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
